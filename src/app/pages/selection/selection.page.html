<ion-header>
    <ion-toolbar color="{{district?._id | districtColor}}" [ngStyle]="district?._id | districtColor | colorStyling">
        <ion-buttons slot="start">
            <ion-back-button></ion-back-button>
        </ion-buttons>
        <ion-title>
            <ng-container *ngIf="district">{{ district.name | districtName: lang }}
                <ng-container *ngIf="shuttles?.length > 0"> ({{shuttles?.length}})</ng-container>
            </ng-container>
            <ng-container *ngIf="currentLocality">{{currentLocality}}
                <ng-container *ngIf="shuttles?.length > 0"> ({{shuttles?.length}})</ng-container>
            </ng-container>
            <ion-spinner color="light" *ngIf="coordinates && !currentLocality && !noValidLocalityName && !outOfRange"
                         name="dots"
                         duration="900"></ion-spinner>
        </ion-title>
    </ion-toolbar>
</ion-header>

<ion-content>
    <ion-virtual-scroll [items]="shuttles$ | async" approxItemHeight="60px">
        <ion-item
                color="{{(shuttle._id | shuttleCalledLately: localDataService.history.getValue().toArray())
                ? 'medium' : ''}}"
                lines="full"
                *virtualItem="let shuttle" (click)="shuttleClicked(shuttle)">
            <ion-thumbnail slot="start">
                <app-sf-shuttle-icon [color]="shuttle | shuttleColor">
                </app-sf-shuttle-icon>
            </ion-thumbnail>
            <ion-label text-wrap>
                <ion-text>
                    <h2>{{ shuttle?.name }}
                        <ion-icon *ngIf="shuttle?.verified" name="checkmark-circle" slot="end"
                                  color="secondary"></ion-icon>
                    </h2>
                    <!--<h4>{{shuttle?.rankingScore}}</h4>-->
                    <p>
                        <ion-badge *ngIf="shuttle?.avgRating?.totalAvg && shuttle?.avgRating?.totalAvg > 0"
                                   color="tertiary">
                            â˜… {{shuttle?.avgRating?.totalAvg}}
                        </ion-badge>
                        <ion-badge
                                *ngIf="coordinates && shuttle?.address?.locality?.de && shuttle?.address?.locality?.it"
                                color="secondary">
                            {{ shuttle.address.locality | localityName: lang}}
                        </ion-badge>
                        <ion-badge
                                *ngIf="!coordinates && shuttle?.address?.locality?.de && shuttle?.address?.locality?.it"
                                [ngStyle]="district?._id | districtColor | colorStyling">
                            {{ shuttle.address.locality | localityName: lang }}
                        </ion-badge>
                    </p>
                </ion-text>
            </ion-label>
            <div class="call-icon-div" (click)="callClicked(shuttle, $event)">
                <ion-icon name="call" size="large" slot="end"
                          color="secondary"></ion-icon>
            </div>
        </ion-item>
    </ion-virtual-scroll>
    <div *ngIf="coordinates && outOfRange">
        <p padding class="no-data-p"> {{ "NO_SHUTTLE_FOUND" | translate }} </p>
    </div>

<!--    <ion-spinner id="big-spinner" *ngIf="shuttles?.length < 1 && !outOfRange" color="tertiary"-->
<!--                 name="crescent"></ion-spinner>-->
</ion-content>
